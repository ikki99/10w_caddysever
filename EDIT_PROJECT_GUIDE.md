# 项目编辑功能使用指南

## ✅ 问题已修复

### 修复的问题
1. ❌ → ✅ 编辑按钮存在但保存按钮文本不变
2. ❌ → ✅ 编辑时无法区分是新建还是编辑
3. ❌ → ✅ 表单清空不完整
4. ❌ → ✅ 托盘图标设置错误

---

## 📝 如何编辑项目

### 方法 1: 通过项目列表
1. 打开管理面板: `http://localhost:8989`
2. 登录后进入"项目管理"标签
3. 找到要编辑的项目
4. 点击项目卡片右侧的 **"编辑"** 按钮
5. 弹出编辑对话框（显示"编辑项目 - 项目名称"）
6. 修改需要的配置
7. 点击 **"保存修改"** 按钮

### 方法 2: 通过向导界面
编辑对话框使用与新建相同的四步向导：
1. **第 1 步**: 项目类型（已预填）
2. **第 2 步**: 基本配置（已预填）
3. **第 3 步**: 域名配置（已预填）
4. **第 4 步**: 高级选项（已预填）

---

## 🎯 界面区别

### 新建项目
```
标题: 新建项目
按钮: [创建项目]
表单: 全部为空
```

### 编辑项目
```
标题: 编辑项目 - 我的API项目
按钮: [保存修改]
表单: 已填充现有配置
```

---

## 📋 可编辑的配置项

### 1. 项目类型
- Go 项目
- Python 项目
- Node.js 项目
- Java 项目
- PHP 站点
- 静态网站

### 2. 基本配置
- ✏️ 项目名称
- ✏️ 项目根目录
- ✏️ 可执行文件路径（Go/Java）
- ✏️ 启动命令
- ✏️ 监听端口
- ✏️ 开机自启
- ✏️ 项目说明

### 3. 域名配置
- ✏️ 绑定域名（多个域名每行一个）
- ✏️ 启用 SSL
- ✏️ 证书邮箱

### 4. 高级选项
- ✏️ 反向代理路径
- ✏️ 额外 Header

---

## ⚠️ 注意事项

### 编辑时的限制
1. **项目类型**: 可以更改，但要确保启动命令兼容
2. **端口号**: 修改后如果项目正在运行需要重启
3. **域名**: 修改后 Caddy 会自动重启应用新配置
4. **SSL 设置**: 修改后会重新申请/删除证书

### 建议做法
1. ✅ 编辑前停止项目
2. ✅ 修改域名前确认 DNS 已解析
3. ✅ 修改完成后测试项目能否正常启动
4. ✅ 检查 Caddy 配置是否正确生成

---

## 🔧 常见编辑场景

### 场景 1: 修改端口
```
1. 点击"编辑"
2. 进入第 2 步
3. 修改端口号: 8080 → 9090
4. 点击"保存修改"
5. 重启项目
```

### 场景 2: 添加域名
```
1. 点击"编辑"
2. 进入第 3 步
3. 在域名栏添加:
   api.example.com
   www.example.com
4. 启用 SSL
5. 填写证书邮箱
6. 点击"保存修改"
```

### 场景 3: 修改启动命令
```
1. 点击"编辑"
2. 进入第 2 步
3. 修改启动命令: ./app → ./app --config prod.conf
4. 点击"保存修改"
5. 重启项目
```

### 场景 4: 启用自动启动
```
1. 点击"编辑"
2. 进入第 2 步
3. 将"开机自启"改为"是"
4. 点击"保存修改"
```

---

## 🎨 界面截图说明

### 项目列表
```
┌─────────────────────────────────────────────────┐
│ 我的API项目  [运行中]                              │
│ 类型: Go | 端口: 8080 | 域名: api.example.com   │
│                                                 │
│ [停止] [重启] [编辑] [删除]  ← 点击"编辑"        │
└─────────────────────────────────────────────────┘
```

### 编辑对话框
```
┌─────────────────────────────────────────────────┐
│  编辑项目 - 我的API项目                     ✕    │
├─────────────────────────────────────────────────┤
│  1. 选择类型  2. 基本配置  3. 域名配置  4. 高级  │
│     (active)                                     │
├─────────────────────────────────────────────────┤
│  项目类型: [Go 项目 ▼]                          │
│                                                 │
│  [下一步]                                       │
├─────────────────────────────────────────────────┤
│  ... (通过向导修改各项配置) ...                  │
├─────────────────────────────────────────────────┤
│  [上一步]  [保存修改]  [取消]  ← 注意按钮文本   │
└─────────────────────────────────────────────────┘
```

---

## 🐛 故障排查

### 问题 1: 点击编辑没反应
**解决**:
- 刷新页面重试
- 检查浏览器控制台是否有错误
- 确认项目存在于数据库中

### 问题 2: 修改保存后没生效
**解决**:
- 检查是否显示"保存成功"提示
- 刷新项目列表
- 检查 Caddy 日志是否有错误

### 问题 3: 编辑后项目无法启动
**解决**:
- 检查修改的配置是否正确
- 查看项目日志: `data/logs/project_<id>.log`
- 确认启动命令和路径正确

### 问题 4: 域名修改后无法访问
**解决**:
- 检查域名格式是否正确
- 确认 DNS 已解析
- 查看 Caddy 配置: `data/caddy/Caddyfile`
- 重启 Caddy 服务

---

## 💡 最佳实践

### 编辑前
1. ✅ 记录当前配置（以防需要恢复）
2. ✅ 停止正在运行的项目
3. ✅ 备份重要数据

### 编辑时
1. ✅ 一次只修改一个配置项
2. ✅ 使用向导逐步修改
3. ✅ 域名格式使用 example.com

### 编辑后
1. ✅ 测试项目启动
2. ✅ 验证域名访问
3. ✅ 检查 SSL 证书状态
4. ✅ 查看运行日志

---

## 📊 编辑 vs 新建对比

| 操作 | 新建 | 编辑 |
|------|------|------|
| 标题 | "新建项目" | "编辑项目 - 项目名" |
| 按钮 | "创建项目" | "保存修改" |
| 表单 | 空白 | 预填充 |
| 操作 | 创建新记录 | 更新现有记录 |
| API | `/api/projects/add` | `/api/projects/update` |
| Caddy | 重启 | 重启 |

---

## 🔜 后续功能

计划中的编辑功能增强：
- [ ] 批量编辑
- [ ] 配置模板
- [ ] 配置历史版本
- [ ] 一键复制配置
- [ ] 导入/导出配置

---

## ✨ 快捷操作

### 键盘快捷键（计划中）
- `Ctrl+E` - 编辑选中项目
- `Ctrl+S` - 保存修改
- `Esc` - 取消编辑

### 快速编辑（计划中）
- 直接在列表中修改常用字段
- 双击项目卡片进入编辑

---

**版本**: v0.0.11  
**更新时间**: 2025年  
**功能状态**: ✅ 已修复并可用

---

## 📞 需要帮助？

如果编辑功能有任何问题：
1. 查看浏览器控制台（F12）
2. 检查项目日志
3. 运行诊断脚本
4. 查看 TROUBLESHOOTING.md
